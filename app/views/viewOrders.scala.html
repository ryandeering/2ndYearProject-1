@(customer: models.users.Customer)
@import play.api.Play.current
@import models.shopping._
@import models.products._
    @import scala.Predef; val x= 0

    <!-- Pass page title and user on to main -->
@main("View Orders", customer) {
	<script 
		src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.4/jspdf.min.js" 
	  integrity="sha256-vIL0pZJsOKSz76KKVCyLxzkOT00vXs+Qz4fYRVMoDhw="
	  crossorigin="anonymous">
	</script>

    <div class="col-md-12">
        @if(flash.containsKey("success")) {
            <div class="alert alert-success">
            @flash.get("success")
            </div>
        }

        @if(x == 0){
            <p>No orders found!</p> <!-- Scala variable used. -->
            }

            <!-- Start of For loop - For each p in products add a row -->
        @for(o <- customer.getOrders()) {

            @x++;
            <p>Order Number: @o.getId()</p>
            <p>Order Date: @o.getOrderDateString()</p>
            <table class="table table-bordered table-hover table-condensed">

                <thead>
                        <!-- The header row-->
                    <tr>
                        <th>Id</th>
                        <th>Name</th>
                        <th>Quantity</th>
                        <th>Price</th>
                        <th>Total</th>
			
                    </tr>
                </thead>
                <tbody>
                    @for(i <- o.getItems()) {

                        <tr>
                            <td>@i.getId</td>
                            <td>@i.getProduct.getName()</td>
                            <td>@i.getQuantity()</td>
                            <td>&euro; @("%.2f".format(i.getPrice()))</td>
                            <td>&euro; @("%.2f".format(i.getItemTotal))</td>
			    <td><button class="btn btn-primary" onclick="const pdf = new jsPDF(); pdf.text(10, 50, 'This Document can be used as a proof of purchase  IdentityCode: @i.getId');  pdf.text(10, 20, 'You purchased the item: @i.getProduct.getName()'); pdf.text(10, 30, 'Quantity Purchased: @i.getQuantity()'); pdf.text(10, 40, 'Your Order Total: @(i.getItemTotal) Euro'); pdf.text(10, 10, `Thanks for shopping with CDR GAMES!`); pdf.save();">Print Receipt</button></td>

                        </tr>
                    }<!-- End of For loop -->

                </tbody>


            </table>
            <div class="row">
                <div class="col-md-12">
                    <p class="text-right"><strong>Order Total: &euro; @("%.2f".format(o.getOrderTotal))</strong></p>
                </div>
            </div>
            <p>
                <a href="@routes.ShoppingCtrl.cancelOrder(o.getId())">
                    <button class="btn btn-primary">Cancel Order</button>
                </a>

            </p>
        }<!-- End of For loop -->

    </div>
}